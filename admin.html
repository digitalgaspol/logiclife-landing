<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruang Kendali CEO | LogicLife</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>body { font-family: 'Outfit', sans-serif; }</style>
</head>
<body class="bg-slate-900 text-white min-h-screen p-6 flex flex-col justify-center items-center selection:bg-amber-500 selection:text-black">

    <div id="layarGembok" class="max-w-md w-full bg-slate-800 p-8 rounded-3xl border border-slate-700 shadow-2xl text-center">
        <div class="text-6xl mb-6">üîí</div>
        <h2 class="text-2xl font-black text-white mb-2">Area Terlarang</h2>
        <p class="text-slate-400 text-sm mb-6">Masukkan PIN CEO untuk membuka Ruang Kendali.</p>
        
        <input type="password" id="pinInput" placeholder="Masukkan PIN..." class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-center text-2xl font-bold text-white focus:border-amber-500 outline-none transition mb-4">
        
        <button id="btnBuka" class="w-full bg-amber-500 text-black font-black text-lg py-4 rounded-xl shadow-[0_0_15px_rgba(245,158,11,0.4)] hover:bg-amber-400 transition">
            BUKA BRANKAS
        </button>
        <p id="pesanError" class="text-red-500 font-bold mt-4 hidden">‚ùå PIN Salah Bos!</p>
    </div>


    <div id="layarAdmin" class="max-w-3xl w-full mx-auto hidden mt-10 pb-20">
        <div class="text-center mb-10">
            <h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-amber-600">RUANG KENDALI CEO</h1>
            <p class="text-slate-400 mt-2">Tambah Aplikasi Baru ke Etalase LogicLife</p>
            <button id="btnTutup" class="mt-4 text-sm text-red-400 hover:text-red-300 font-bold underline">üîí Kunci Kembali</button>
        </div>

        <div class="bg-slate-800 p-8 rounded-3xl border border-slate-700 shadow-2xl">
            <form id="formTambahApp" class="space-y-6">
                <div>
                    <label class="block text-sm font-bold text-slate-400 mb-2">ID Aplikasi (Huruf kecil semua, tanpa spasi)</label>
                    <input type="text" id="app_id" placeholder="misal: logiccuan" required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-400 mb-2">Nama Aplikasi</label>
                        <input type="text" id="app_name" placeholder="misal: LogicCuan" required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-400 mb-2">Tagline (Singkat)</label>
                        <input type="text" id="app_tagline" placeholder="misal: Rebahan Dibayar Saldo" required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-400 mb-2">Deskripsi Promosi</label>
                    <textarea id="app_desc" rows="3" placeholder="Jelaskan kenapa orang harus download aplikasi ini..." required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition"></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-400 mb-2">Link Gambar Logo/Banner (.png/.jpg)</label>
                        <input type="url" id="image_url" placeholder="https://..." required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-400 mb-2">Link Download APK (Gdrive/Mediafire)</label>
                        <input type="url" id="download_url" placeholder="https://..." required class="w-full bg-slate-900 border border-slate-700 rounded-xl p-4 text-white focus:border-amber-500 outline-none transition">
                    </div>
                </div>

                <div class="flex items-center gap-3 bg-slate-900 p-4 rounded-xl border border-slate-700">
                    <input type="checkbox" id="is_hot" class="w-6 h-6 accent-amber-500">
                    <label for="is_hot" class="font-bold text-amber-500 cursor-pointer">Tandai sebagai Aplikasi "SEDANG VIRAL üî•"</label>
                </div>

                <button type="submit" id="btnSimpan" class="w-full bg-gradient-to-r from-amber-400 to-amber-600 text-black font-black text-lg py-4 rounded-xl shadow-[0_0_20px_rgba(245,158,11,0.4)] hover:scale-[1.02] transition">
                    üöÄ UPLOAD KE DATABASE
                </button>
            </form>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // Kunci Brankas Bos
        const firebaseConfig = {
            apiKey: "AIzaSyCcikKuctVp6fI0XpxZiVPflzQtBUyqGNQ",
            authDomain: "ruang-ceo.firebaseapp.com",
            projectId: "ruang-ceo",
            storageBucket: "ruang-ceo.firebasestorage.app",
            messagingSenderId: "746766002415",
            appId: "1:746766002415:web:6ef5c75c811120f67bd31a"
        };

        let db; // Database baru nyala kalau PIN benar

        // --- LOGIKA SATPAM (GEMBOK PIN) ---
        const PIN_RAHASIA = "M3isy4851"; 
        const btnBuka = document.getElementById('btnBuka');
        const pinInput = document.getElementById('pinInput');
        const layarGembok = document.getElementById('layarGembok');
        const layarAdmin = document.getElementById('layarAdmin');
        const pesanError = document.getElementById('pesanError');
        const btnTutup = document.getElementById('btnTutup');

        btnBuka.addEventListener('click', () => {
            if (pinInput.value === PIN_RAHASIA) {
                // PIN Benar! Buka form dan nyalakan Firebase
                layarGembok.classList.add('hidden');
                layarAdmin.classList.remove('hidden');
                document.body.classList.remove('justify-center', 'items-center'); // Benerin layout
                
                // Nyalakan Mesin Firebase sekarang
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
            } else {
                // PIN Salah
                pesanError.classList.remove('hidden');
                pinInput.value = ''; // Kosongkan input
            }
        });

        // Biar bisa pencet Enter pas masukin PIN
        pinInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') btnBuka.click();
        });

        // Tombol Kunci Kembali
        btnTutup.addEventListener('click', () => {
            location.reload(); // Refresh halaman buat ngegembok ulang
        });

        // --- LOGIKA SIMPAN DATA (Sama kayak tadi) ---
        const form = document.getElementById('formTambahApp');
        const btnSimpan = document.getElementById('btnSimpan');

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); 
            btnSimpan.innerHTML = "‚è≥ MENGIRIM DATA...";
            btnSimpan.disabled = true;

            const appId = document.getElementById('app_id').value.trim().toLowerCase();

            const dataApp = {
                name: document.getElementById('app_name').value,
                tagline: document.getElementById('app_tagline').value,
                description: document.getElementById('app_desc').value,
                image_url: document.getElementById('image_url').value,
                download_url: document.getElementById('download_url').value,
                is_hot: document.getElementById('is_hot').checked,
                created_at: serverTimestamp()
            };

            try {
                await setDoc(doc(db, "products", appId), dataApp);
                alert("‚úÖ BERHASIL BOS! Aplikasi masuk ke Etalase!");
                form.reset(); 
            } catch (error) {
                console.error("Error: ", error);
                alert("‚ùå GAGAL: " + error.message);
            } finally {
                btnSimpan.innerHTML = "üöÄ UPLOAD KE DATABASE";
                btnSimpan.disabled = false;
            }
        });
    </script>
</body>
</html>